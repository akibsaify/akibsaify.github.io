<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Portfolio Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .loading-shimmer {
            background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    </style>
</head>
<body class="bg-[#f8fafc] text-slate-900 antialiased transition-colors duration-500">

    <!-- Setup Screen (Shown first) -->
    <div id="setup-screen" class="min-h-screen flex items-center justify-center p-6 bg-slate-900 text-white">
        <div class="max-w-md w-full space-y-8 text-center">
            <div class="inline-flex p-4 rounded-3xl bg-blue-600/20 text-blue-400 mb-4">
                <i data-lucide="sparkles" class="w-10 h-10"></i>
            </div>
            <div class="space-y-2">
                <h1 class="text-3xl font-bold tracking-tight">Personal Identity Sync</h1>
                <p class="text-slate-400 text-sm">Enter your name or professional handle. I will search the web for your data and generate your portfolio.</p>
            </div>
            <div class="relative">
                <input type="text" id="identity-input" placeholder="e.g. 'Jane Doe Developer' or '@handle'" 
                    class="w-full bg-slate-800/50 border border-slate-700 rounded-2xl py-4 px-6 text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            </div>
            <button id="generate-btn" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-2xl transition-all shadow-xl shadow-blue-500/20 flex items-center justify-center gap-2">
                <span id="btn-text">Generate My Site</span>
                <i data-lucide="arrow-right" class="w-5 h-5" id="btn-icon"></i>
            </button>
            <p id="error-msg" class="hidden text-red-400 text-sm bg-red-400/10 p-3 rounded-xl"></p>
        </div>
    </div>

    <!-- Main Website (Hidden until generated) -->
    <div id="site-wrapper" class="hidden min-h-screen">
        <nav class="fixed top-0 w-full z-50 bg-white/70 backdrop-blur-xl border-b border-slate-200/50 py-4">
            <div class="max-w-4xl mx-auto px-6 flex justify-between items-center">
                <div class="text-xl font-black tracking-tighter text-blue-600 uppercase cursor-pointer" onclick="location.reload()">
                    <span id="nav-name">PORTFOLIO</span>
                </div>
                <div class="flex bg-slate-100 p-1 rounded-full">
                    <button onclick="switchTab('home')" class="nav-btn active px-4 py-1.5 rounded-full text-sm font-semibold text-blue-600 bg-white shadow-sm">Home</button>
                    <button onclick="switchTab('blog')" class="nav-btn px-4 py-1.5 rounded-full text-sm font-semibold text-slate-500">Blog</button>
                    <button onclick="switchTab('projects')" class="nav-btn px-4 py-1.5 rounded-full text-sm font-semibold text-slate-500">Projects</button>
                </div>
            </div>
        </nav>

        <main class="pt-32 pb-20 max-w-4xl mx-auto px-6">
            <!-- Home Tab -->
            <section id="home" class="tab-content active space-y-20">
                <div class="space-y-6">
                    <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-50 text-blue-600 text-xs font-bold uppercase tracking-widest">
                        <i data-lucide="globe" class="w-3 h-3"></i> <span>Live Identity Sync</span>
                    </div>
                    <h1 id="hero-tagline" class="text-5xl md:text-7xl font-extrabold tracking-tight leading-[1.1]"></h1>
                    <p id="hero-bio" class="text-xl text-slate-500 max-w-2xl leading-relaxed"></p>
                    <div class="flex items-center gap-4 text-slate-400" id="social-links"></div>
                </div>

                <div class="space-y-8">
                    <h3 class="text-sm font-bold text-slate-400 uppercase tracking-widest">Expertise</h3>
                    <div class="flex flex-wrap gap-2" id="skills-list"></div>
                </div>
            </section>

            <!-- Blog Tab -->
            <section id="blog" class="tab-content space-y-12">
                <div>
                    <h2 class="text-4xl font-bold mb-4">Writings</h2>
                    <p class="text-slate-500">Articles and insights curated from your career profile.</p>
                </div>
                <div id="blog-list" class="space-y-10"></div>
            </section>

            <!-- Projects Tab -->
            <section id="projects" class="tab-content space-y-12">
                <div>
                    <h2 class="text-4xl font-bold mb-4">Selected Work</h2>
                    <p class="text-slate-500">Projects discovered during the identity sync.</p>
                </div>
                <div id="project-list" class="grid md:grid-cols-2 gap-8"></div>
            </section>
        </main>

        <footer class="py-20 border-t border-slate-200 text-center bg-white">
            <p class="text-sm font-bold text-slate-400 uppercase tracking-widest mb-2">Get in touch</p>
            <h2 id="footer-name" class="text-2xl font-bold mb-8"></h2>
            <div class="flex justify-center gap-6 text-slate-400" id="footer-socials"></div>
            <p class="mt-12 text-xs text-slate-400">© <span id="year"></span> • Built with Gemini Search Grounding</p>
        </footer>
    </div>

    <script>
        const apiKey = ""; // Runtime provided key
        let userData = null;

        // Initialize Icons
        lucide.createIcons();
        document.getElementById('year').innerText = new Date().getFullYear();

        // Gemini API with Search Grounding
        async function fetchIdentity(identity, retries = 0) {
            const btn = document.getElementById('generate-btn');
            const errorEl = document.getElementById('error-msg');
            
            btn.disabled = true;
            document.getElementById('btn-text').innerText = "Searching Web...";
            errorEl.classList.add('hidden');

            const prompt = `
                Search the web for professional information about: ${identity}.
                Return a structured JSON object for a personal portfolio website. 
                Include: name, tagline, bio (2 sentences), location, 
                socials (github, linkedin, twitter URLs), 
                projects (3 items with title, description, tech stack, link),
                blogPosts (3 items with title, summary, date, category),
                skills (list of 6 professional skills).
                Respond ONLY with JSON.
            `;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        tools: [{ "google_search": {} }],
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });

                if (!response.ok) throw new Error('Search request failed');

                const data = await response.json();
                const jsonText = data.candidates[0].content.parts[0].text;
                userData = JSON.parse(jsonText);
                
                renderSite(userData);
            } catch (err) {
                if (retries < 3) {
                    setTimeout(() => fetchIdentity(identity, retries + 1), 2000);
                } else {
                    errorEl.innerText = "We couldn't find enough public data for that name. Try adding more context like a city or job title.";
                    errorEl.classList.remove('hidden');
                    btn.disabled = false;
                    document.getElementById('btn-text').innerText = "Generate My Site";
                }
            }
        }

        function renderSite(data) {
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('site-wrapper').classList.remove('hidden');

            document.getElementById('nav-name').innerText = data.name.split(' ')[0];
            document.getElementById('hero-tagline').innerText = data.tagline;
            document.getElementById('hero-bio').innerText = data.bio;
            document.getElementById('footer-name').innerText = data.name;

            // Render Skills
            const skillContainer = document.getElementById('skills-list');
            skillContainer.innerHTML = data.skills.map(s => `
                <span class="px-4 py-2 bg-white border border-slate-200 rounded-xl text-sm font-semibold text-slate-700 shadow-sm">${s}</span>
            `).join('');

            // Render Socials
            const socialHtml = Object.entries(data.socials).map(([key, url]) => `
                <a href="${url}" target="_blank" class="hover:text-blue-600 transition-colors">
                    <i data-lucide="${key}" class="w-6 h-6"></i>
                </a>
            `).join('');
            document.getElementById('social-links').innerHTML = socialHtml;
            document.getElementById('footer-socials').innerHTML = socialHtml;

            // Render Projects
            document.getElementById('project-list').innerHTML = data.projects.map(p => `
                <div class="bg-white border border-slate-200 p-8 rounded-[2rem] hover:border-blue-200 hover:shadow-2xl hover:shadow-blue-500/5 transition-all">
                    <h3 class="text-xl font-bold mb-2">${p.title}</h3>
                    <p class="text-slate-500 mb-6 text-sm leading-relaxed">${p.description}</p>
                    <div class="flex flex-wrap gap-2 mb-6">
                        ${p.tech.map(t => `<span class="text-[10px] font-bold uppercase tracking-wider text-slate-400">${t}</span>`).join('')}
                    </div>
                    <a href="${p.link}" target="_blank" class="inline-flex items-center text-blue-600 font-bold text-sm">
                        View Project <i data-lucide="external-link" class="w-4 h-4 ml-2"></i>
                    </a>
                </div>
            `).join('');

            // Render Blog
            document.getElementById('blog-list').innerHTML = data.blogPosts.map(post => `
                <div class="group cursor-pointer border-b border-slate-100 pb-10">
                    <div class="text-xs font-bold text-blue-600 mb-2 uppercase tracking-widest">${post.category} • ${post.date}</div>
                    <h3 class="text-2xl font-bold mb-3 group-hover:text-blue-600 transition-colors">${post.title}</h3>
                    <p class="text-slate-500 leading-relaxed mb-4 max-w-2xl">${post.summary}</p>
                    <div class="text-sm font-bold flex items-center group-hover:gap-2 transition-all">
                        Read Full Story <i data-lucide="chevron-right" class="w-4 h-4 ml-1"></i>
                    </div>
                </div>
            `).join('');

            lucide.createIcons();
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');

            document.querySelectorAll('.nav-btn').forEach(b => {
                b.classList.remove('active', 'bg-white', 'text-blue-600', 'shadow-sm');
                b.classList.add('text-slate-500');
            });

            const activeBtn = document.querySelector(`button[onclick="switchTab('${tabId}')"]`);
            activeBtn.classList.add('active', 'bg-white', 'text-blue-600', 'shadow-sm');
            activeBtn.classList.remove('text-slate-500');

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.getElementById('generate-btn').addEventListener('click', () => {
            const val = document.getElementById('identity-input').value;
            if (val) fetchIdentity(val);
        });

        document.getElementById('identity-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') document.getElementById('generate-btn').click();
        });
    </script>
</body>
</html>

